@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer

@{
    ViewData["Title"] = "Customers";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="content ListPage pt-1">
    <div class="page-header">
        <div class="page-title">
            <h4>@Localizer["CustomerManagement"]</h4>
            <h6>@Localizer["Add/UpdateCustomer"]</h6>
        </div>
        <div class="page-btn">
            <div class="wordset newwordset">
                <ul>
                    <li>
                        <a data-bs-toggle="tooltip" data-bs-placement="top" title="Word" id="convertWord">
                            <i class="far fa-file-word" style="color: #000000; font-size:21px;"></i>
                        </a>
                    </li>
                    <li>
                        <a data-bs-toggle="tooltip" data-bs-placement="top" title="PDF" id="pdfPrint">
                            <i class="far fa-file-pdf" style="color: #000000; font-size:21px;"></i>
                        </a>
                    </li>
                    <li>
                        <a data-bs-toggle="tooltip" data-bs-placement="top" title="Excel" id="convertExcel">
                            <i class="far fa-file-excel" style="color: #000000; font-size:21px;"></i>
                        </a>
                    </li>
                    <li>
                        <a data-bs-toggle="tooltip" data-bs-placement="top" title="CSV" id="convertCsv">
                            <i class="fa fa-file-csv" style="color: #000000; font-size:21px;"></i>
                        </a>
                    </li>
                    <li>
                        <a href="/Home/Index" role="button">
                            <i class="fas fa-times-circle fs-22" style="color: #000000;"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <div class="table-top table-topm">
                <div class="search-set">
                    <div class="search-path">
                        <a class="btn btn-filter" id="filter_search_rm">
                            <img src="~/assets/img/icons/filter.svg" alt="img">
                            <span><img src="~/assets/img/icons/closes.svg" alt="img"></span>
                        </a>
                    </div>
                    <div class="search-input">
                        <input type="search" id="txtSearch">
                    </div>
                </div>
                @*<div class="wordset">
                    <p href="javascript:void(0);" class="btn btn-addednew btnAdd ct-btns">
                        <img src="~/assets/img/icons/plus.svg" alt="img" class="me-1">Add New
                    </p>
                </div>*@
            </div>

            <div class="table-responsive" style="height:395px;">
                <table class="table text-white table-hover" id="tbl-print">
                    <thead>
                        <tr>
                            <th class="ps-2"><input type="checkbox" checked class="printCheckBox notPrintCol" />Id</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["FirstName"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["SecondName"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["Gender"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["Dob"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["Address1"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["Address2"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["Country"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["City"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["State"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["PostalCode"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["ContactNo"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />@Localizer["Email"]</th>
                            <th class="pe-3"><input type="checkbox" checked class="printCheckBox notPrintCol" />Type</th>
                            <th class="text-center pe-3 last-th-sticky"><input type="checkbox" class="printCheckBox notPrintCol" hidden>@Localizer["Action"]</th>
                        </tr>
                    </thead>
                    <tbody id="allUsersList">
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="content AddPage pt-1">
    <div class="page-header">
        <div class="page-title">
            <h4>@Localizer["CustomerAdd"]</h4>
        </div>
        <div class="page-btn">
            <a href="javascript:void(0);" class="btn btn-added btnList ct-btns">
                <i class="fa me-2 fa-th-list" data-bs-toggle="tooltip" title="" data-bs-original-title="" aria-label="fa fa-th-list"></i> @Localizer["Customers"]
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <div class="row">
                <div class="col-lg-8 col-md-8 col-sm-12">
                    <div class="row activeForm disabled">

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["FirstName"]</label>
                                <input type="text" class="" id="txtFirstName" skinid="">
                                <input type="hidden" id="txtUserId">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["SecondName"]</label>
                                <input type="text" class="" id="txtSecondName" skinid="">
                            </div>
                        </div>
                        
                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["UserName"]</label>
                                <input type="text" class="" id="txtUserName" skinid="">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["Password"]</label>
                                <div class="pass-group">
                                    <input type="password" class="pass-input" id="userPassword" skinid="Enter Password....!">
                                    <span class="fas toggle-password fa-eye-slash"></span>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["ConfirmPassword"]</label>
                                <div class="pass-group">
                                    <input type="password" class="pass-inputs" id="userConfirmPassword" skinid="Enter Confirm Password....!">
                                    <span class="fas toggle-passworda fa-eye-slash"></span>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["Gender"]</label>
                                <select class="form-control" id="drpUserGender" skinid="">
                                    <option value="0">--- Gender ---</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["DOB"]</label>
                                <input type="text" placeholder="DD-MM-YYYY" class="datetimepicker" id="txtUserDob">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["Address1"]</label>
                                <input type="text" class="" id="txtUserAddress1" skinid="">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["Address2"]</label>
                                <input type="text" class="" id="txtUserAddress2" skinid="">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["Country"]</label>
                                <input type="text" class="" id="txtCountry" skinid="">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["City"]</label>
                                <input type="text" class="" id="txtCity" skinid="">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["State"]</label>
                                <input type="text" class="" id="txtState" skinid="">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["PostalCode"]</label>
                                <input type="text" class="" id="txtPostalCode" skinid="">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["Contact"]</label>
                                <input type="text" class="" id="txtUserContact" skinid="">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["Email"]</label>
                                <input type="email" class="" id="txtUserEmail" skinid="">
                            </div>
                        </div>

                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <div class="form-group">
                                <label>@Localizer["Active"]</label>
                                <input type="checkbox" class="" id="txtUserActive" style="margin-top:10px; height:19px; width:19px;" skinid="">
                            </div>
                        </div>
                        
                    </div>
                </div>
             <div class="col-lg-4 col-md-4 col-sm-12 activeForm disabled">
                 <div class="commom-img mb-2 mt-1">
                        <img src="" id="ImageUser" />
                    </div>
                    <div class="form-group">
                        <input class="form-control" type="file" id="userImg" accept="image/jpg, image/jpeg, image/png" />
                    </div>
            </div>
            </div>
            <div class="row">
                <div class="mb-2">
                    <button class="btn btn-primary btn-sm ct-btns" id="btnNewUser">@Localizer["New"]</button>
                    <button class="btn btn-success btn-sm ct-btns" id="btnSaveUser">@Localizer["Save"]</button>
                    <button class="btn btn-secondary btn-sm ct-btns" id="btnRefreshUser">@Localizer["Refresh"]</button>
                </div>
            </div>
        </div>
    </div>
</div>


@section scripts{
    <script>

        $(function(){
            $(".AddPage").hide();
            GetUsersList();
            $("#btnRefreshUser").click();
        })

        $(".btnAdd").click(function () {
            $(".ListPage").hide();
            $(".AddPage").show();
            $("#txtUserId").val("");
            $("#btnRefreshUser").click();
        });

        $(".btnList").click(function () {
            $(".ListPage").show();
            $(".AddPage").hide();
        });

        //====================== Users ========================\\

        function GetUsersList(){
            try {
                $.ajax({
                    type: "Get",
                    contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                    url: "/User/GetCustomers/",
                    async: false,
                    dataType: "json",
                    success: function (data) {
                        $("#allUsersList").empty();
                        $.each(data, function (i, item) {

                            var dob = moment(item.dob).format("DD-MM-YYYY");

                            $("#allUsersList").append(`
                             <tr>
                                 <td class="userId ps-2">${item.customerId}</td>
                                 <td class="userFirstName">${item.firstName}</td>
                                 <td class="userSecondName">${item.secondName}</td>
                                 <td class="userGender">${item.gender}</td>
                                 <td class="userDob">${dob}</td>
                                 <td class="userAddress1">${item.address1}</td>
                                 <td class="userAddress2">${item.address2}</td>
                                 <td class="userCountry">${item.country}</td>
                                 <td class="userCity">${item.city}</td>
                                 <td class="userState">${item.state}</td>
                                 <td class="userPostalCode">${item.postalCode}</td>
                                 <td class="userContact">${item.contactNo}</td>
                                 <td class="userEmail">${item.email}</td>
                                 <td class="userType">${item.type}</td>
                                 <td class="text-center last-td-sticky">
                                             <span class="me-2 btnEditUser cursor-pointer" >
                                                 <img src="/assets/img/icons/edit.svg" alt="img">
                                             </span>
                                             <span class="confirm-text btnDelUser cursor-pointer" >
                                                 <img src="/assets/img/icons/delete.svg" alt="img">
                                             </span>
                                 </td>
                                 <td class="profilePic d-none">${item.profilePic}</td>
                                 <td class="userName d-none">${item.userName}</td>
                                 <td class="upas d-none">${item.password}</td>
                                 <td class="userActiveStatus d-none">${item.activeStatus}</td>
                             </tr>
                            `)
                        });

                    },
                    error: function (data) {
                    }
                });
            }
            catch (err) {
                alert(err)
            }
        }


        $("#btnSaveUser").click(function () {

            // Password Confirm
            var userPassword = $("#userPassword").val();
            var userConfirmPassword = $("#userConfirmPassword").val();

            if (userPassword != userConfirmPassword){
                toastr.warning("Confirm Password Not Mach", "", { closeButton: !0, tapToDismiss: !1, ltl: o });
                    return false;
            }

            if (userConfirmPassword.length < 6){
                toastr.warning("Password must be in 6 digits", "", { closeButton: !0, tapToDismiss: !1, ltl: o });
                    return false;
            }

            // Email Validation
            var txtUserEmail = $('#txtUserEmail').val();
            var emailRegex = /^[a-zA-Z0-9._%+-]+@@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

            if (txtUserEmail.length > 0) {
                if (!emailRegex.test(txtUserEmail)) {
                    toastr.warning("Invalid Email Address", "", { closeButton: !0, tapToDismiss: !1, ltl: o });
                    $('#txtUserEmail').focus();
                    return false;
                }
            }

            var activeStatus = false;
            if ($("#txtUserActive").is(":checked")){ activeStatus = true }

            var vDate = $("#txtUserDob").val();
            var datePart = vDate.split("-");
            var dateObject = new Date(+datePart[2], datePart[1] - 1, +datePart[0]);
            var dob = moment(dateObject).format("YYYY/MM/DD");

            if (CheckValidation("AddPage") == false) {

                    return false;
            }

            var formData = new FormData();

            var totalFiles = document.getElementById("userImg").files.length;
            for (var i = 0; i < totalFiles; i++) {
                var file = document.getElementById("userImg").files[i];
                formData.append("profilePic", file);
            }

            formData.append("id", $("#txtUserId").val());
            formData.append("firstName", $("#txtFirstName").val());
            formData.append("secondName", $("#txtSecondName").val());
            formData.append("userName", $("#txtUserName").val());
            formData.append("password", userConfirmPassword);
            formData.append("gender", $("#drpUserGender option:selected").val());
            formData.append("dob", dob);
            formData.append("userAddress1", $("#txtUserAddress1").val());
            formData.append("userAddress2", $("#txtUserAddress2").val());
            formData.append("country", $("#txtCountry").val());
            formData.append("city", $("#txtCity").val());
            formData.append("state", $("#txtState").val());
            formData.append("postalCode", $("#txtPostalCode").val());
            formData.append("contactNo", $("#txtUserContact").val());
            formData.append("email", txtUserEmail);
            formData.append("activeStatus", activeStatus);

            ////CheckDuplicateEntry(NameMatch, LoopTableBodyId, TableDataNameMatchByClass, IgnoreValueId, IngoreValClassInTable)
            //if (CheckDuplicateEntry($("#txtUserName").val().trim(), "#allUsersList", ".userName", $("#txtUserId").val(), ".userId") == false) {
            //    toastr.info("User Name Already Added.", "", { closeButton: !0, tapToDismiss: !1, ltl: o });
            //    $("#txtUserName").focus();
            //    return false;
            //}

            try {
                $.ajax({
                    type: "POST",
                    contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                    url: "/User/SaveCustomers/",
                    data: formData,
                    async: false,
                    dataType: "json",
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        if (data != false) {
                            toastr.success("Save Successfully", "", { closeButton: !0, tapToDismiss: !1, ltl: o });
                            GetUsersList();
                            //$("#txtUserId").val("");
                            //$("#btnRefreshUser").click();
                            
                            $(".btnList").click();
                        }
                        else {
                            toastr.error("Please Save Again", "", { closeButton: !0, tapToDismiss: !1, ltl: o });
                        }
                    },
                    error: function () {
                    }
                });
            }
            catch (err) {
                alert(err)
            }
        });

        $('body').on('click', ".btnDelUser", function(){

            var x = confirm("Are you sure you want to delete?");
            if (x == false) { return false; }

            var obj = {};
            obj.id = $(this).closest('tr').find(".userId").text();
            obj.profilePic = $(this).closest('tr').find(".profilePic").text();


            try {
                $.ajax({
                    type: "POST",
                    contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                    url: "/User/DelCustomers/",
                    data: obj,
                    async: false,
                    dataType: "json",
                    success: function (data) {
                        if (data != false) {
                            toastr.success("Deleted Successfully", "", { closeButton: !0, tapToDismiss: !1, ltl: o });
                            GetUsersList();
                            $("#txtUserId").val("");
                            $("#btnRefreshUser").click();
                        }
                        else {
                            toastr.error("Please Delete Again", "", { closeButton: !0, tapToDismiss: !1, ltl: o });
                        }
                    },
                    error: function () {
                    }
                });
            }
            catch (err) {
                alert(err)
            }
        });

        $("body").on('click', '.btnEditUser', function () {

            $(".activeForm").removeClass('disabled');

            var id = $(this).closest('tr').find('.userId').text();
            var FirstName = $(this).closest('tr').find('.userFirstName').text();
            var SecondName = $(this).closest('tr').find('.userSecondName').text();
            var userName = $(this).closest('tr').find('.userName').text();
            var gender = $(this).closest('tr').find('.userGender').text();
            var dob = $(this).closest('tr').find('.userDob').text();
            var Address1 = $(this).closest('tr').find('.userAddress1').text();
            var Address2 = $(this).closest('tr').find('.userAddress2').text();
            var Country = $(this).closest('tr').find('.userCountry').text();
            var City = $(this).closest('tr').find('.userCity').text();
            var State = $(this).closest('tr').find('.userState').text();
            var PostalCode = $(this).closest('tr').find('.userPostalCode').text();
            var Contact = $(this).closest('tr').find('.userContact').text();
            var Email = $(this).closest('tr').find('.userEmail').text();

            $("#txtUserId").val(id);
            $("#txtFirstName").val(FirstName);
            $("#txtSecondName").val(SecondName);
            $("#txtUserName").val(userName);
            $("#txtUserName").addClass('disabled');
            $("#drpUserGender").val(gender);
            $("#txtUserAddress1").val(Address1);
            $("#txtUserAddress2").val(Address2);
            $("#txtCountry").val(Country);
            $("#txtCity").val(City);
            $("#txtState").val(State);
            $("#txtPostalCode").val(PostalCode);
            $("#txtUserContact").val(Contact);
            $("#txtUserEmail").val(Email);
            $("#txtUserDob").val(dob);

            var activeStatus = $(this).closest('tr').find('.userActiveStatus').text();
            if(activeStatus == "true"){
                $("#txtUserActive").prop('checked', true);
            }
            else{
                $("#txtUserActive").prop('checked', false);
            }

            var upas = $(this).closest('tr').find('.upas').text();
            $("#userPassword").val(upas);
            $("#userConfirmPassword").val(upas);

            var userImg = $(this).closest('tr').find('.profilePic').text();
            var path = window.location.origin;
            $("#ImageUser").attr('src', path + "/" + userImg);

            $("#btnSaveUser").show();
            $("#btnNewUser").hide();
            $("#btnSaveUser").text('Update');

            $(".ListPage").hide();
            $(".AddPage").show();

            $("#txtFirstName").addClass('disabled');
            $("#txtSecondName").addClass('disabled');
            $("#txtUserName").addClass('disabled');
            $("#drpUserGender").addClass('disabled');
            $("#txtUserAddress1").addClass('disabled');
            $("#txtUserAddress2").addClass('disabled');
            $("#txtCountry").addClass('disabled');
            $("#txtCity").addClass('disabled');
            $("#txtState").addClass('disabled');
            $("#txtPostalCode").addClass('disabled');
            $("#txtUserContact").addClass('disabled');
            $("#txtUserEmail").addClass('disabled');
            $("#txtUserDob").addClass('disabled');
            $("#userPassword").addClass('disabled');
            $("#userConfirmPassword").addClass('disabled');
            $("#userImg").addClass('disabled');

        });


        //====================== Buttons ========================\\

        $("#btnNewUser").click(function () {
            $(".activeForm").removeClass('disabled');
            
            $(this).hide();
            $("#btnSaveUser").text('Save');
            $("#btnSaveUser").show();
            $("#txtFirstName").focus();
        });

        $("#btnRefreshUser").click(function () {

            var uId = $("#txtUserId").val();

            if (uId != 0) {
                $(".userId").each(function () {
                    const userIdValue = $(this).text().trim();
                    if (userIdValue === uId) {
                        $(this).closest('tr').find('.btnEditUser').click();
                        return false;
                    }
                });
            }
            else {

                $(".activeForm").addClass('disabled');

                $("#btnSaveUser").hide();
                $("#btnNewUser").show();

                $("#txtUserId").val('');
                $("#txtFirstName").val('');
                $("#txtSecondName").val('');
                $("#txtUserName").val('');
                $("#txtUserName").removeClass('disabled');
                $("#drpUserGender").val('0');
                $("#txtUserDob").val('');
                $("#txtUserAddress1").val('');
                $("#txtUserAddress2").val('');
                $("#txtCountry").val('');
                $("#txtCity").val('');
                $("#txtState").val('');
                $("#txtPostalCode").val('');
                $("#txtUserContact").val('');
                $("#txtUserEmail").val('');
                $("#userPassword").val('');
                $("#userConfirmPassword").val('');
                $("#txtUserActive").prop('checked', false);

                $("#ImageUser").attr('src', '');
                $("#userImg").val('');
            }
        });


        //====================== Search ========================\\

        $(document).on('input', '#txtSearch', function () {
            var value = $(this).val().toLowerCase();
            $("#allUsersList tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });


        $('body').on('input', "#txtUserContact, #userPassword, #userConfirmPassword", function () {

            const inputValue = $(this).val();
            $(this).val(inputValue.replace(/[^0-9+]/g, ''));

            if ($(this).prop('id') != "txtUserContact") {

                var v = $(this).val();

                if (v.length > 6) {
                    v = v.substring(0, 6);
                    $(this).val(v);
                }

            }

        });

        //====================== User Image ========================\\
        $("body #userImg").change(function (event) {
            $("#ImageUser").attr('src', URL.createObjectURL(event.target.files[0]));
        });

        //====================== Word Convert ========================\\

        $('#convertWord').click(function () {
            $(".printCheckBox").trigger('change');

            HTMLtoWORD("tbl-print", "@ViewData["Title"]")
        });

        //====================== Grid Print Start ========================\\

        $('#pdfPrint').click(function () {
            $(".printCheckBox").trigger('change');

            var cloneTable = $("#tbl-print").clone();
            cloneTable.find('.d-none, .notPrintCol').remove();
            $(cloneTable).printThis();
        });

        //====================== Excel Convert ========================\\

        $("#convertExcel").click(function () {
            $(".printCheckBox").trigger('change');

            var cloneTable = $("#tbl-print").clone();
            cloneTable.find('.d-none, .notPrintCol').remove();

            TableToExcel.convert($(cloneTable)[0], {
                name: "@ViewData["Title"]" + ".xlsx",
                sheet: {
                    name: "@ViewData["Title"]"
                },

            });
        });

        //====================== Csv Convert ========================\\

        $("#convertCsv").click(function () {
            $(".printCheckBox").trigger('change');

            var cloneTable = $("#tbl-print").clone();
            cloneTable.find('.d-none, .notPrintCol').remove();

            var csvContent = "data:text/csv;charset=utf-8,";

            var headers = [];
            cloneTable.find("thead th").each(function () {
                headers.push($(this).text().trim());
            });

            csvContent += headers.join(",") + "\r\n";

            var tbody = cloneTable.find("tbody");

            tbody.find("tr").each(function () {
                var row = [];

                $(this).find("td").each(function () {
                    row.push($(this).text().trim());
                });

                csvContent += row.join(",") + "\r\n";
            });

            var encodedUri = encodeURI(csvContent);

            var link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "@ViewData["Title"]"+".csv");

            document.body.appendChild(link);
            link.click();

            document.body.removeChild(link);
        });

        //================ Select Column By CheckBox ==================\\
        $(".printCheckBox").change(function () {
            const columnIndex = $(this).closest("th").index();
            const isChecked = $(this).is(":checked");
            const colClassToAdd = isChecked ? "PrintCol" : "notPrintCol";
            const colClassToRemove = isChecked ? "notPrintCol" : "PrintCol";

            $("#tbl-print tr").each(function () {
                const $cells = $(this).find(`th:eq(${columnIndex}), td:not(.d-none):eq(${columnIndex})`);
                $cells.removeClass(colClassToRemove).addClass(colClassToAdd);
            });
        });


    </script>
}